import{D as h,a5 as v,H as y,r as g,j as e,G as o,M as p,T as j,bc as S,F}from"./index-DY3ttFyu.js";import{C as w}from"./index-CsVKesDI.js";import{Q as D}from"./index-s9vm75KP.js";import{E as C}from"./index-B8hqVW8S.js";import{B as A}from"./Button-C6FJzEoW.js";import"./EllipsisOutlined-D5ZMTf_s.js";import"./KeyCode-DPqf1Y-U.js";import"./Overflow-GpditJPY.js";import"./index-Ce7nyR-M.js";import"./useForkRef-kdbJMlYF.js";const E=n=>{switch(new Date(`${n}`).getMonth()+1){case 1:return"January";case 2:return"February";case 3:return"March";case 4:return"April";case 5:return"May";case 6:return"June";case 7:return"July";case 8:return"August";case 9:return"September";case 10:return"October";case 11:return"November";default:return"December"}},k=n=>{const{subscription:c,choice:a}=h(s=>s.event),r=v({queryKey:["assignedDevice"],queryFn:()=>y.post("/receiver/receiver-assigned-list",{user:n.info.consumerInfo.email,eventSelected:a}),refetchOnMount:!1});if(g.useEffect(()=>{const s=new AbortController;return r.refetch(),()=>{s.abort()}},[]),n){const s=t=>e.jsx("span",{style:{borderRadius:"16px",justifyContent:"center",display:"flex",padding:"2px 8px",alignItems:"center",background:`${t?"var(--blue-50, #EFF8FF)":"var(--success-50, #ECFDF3)"}`,width:"fit-content"},children:e.jsxs(j,{color:`${t?"var(--blue-700, #175CD3)":"var(--success-700, #027A48)"}`,fontSize:"12px",fontFamily:"Inter",fontStyle:"normal",fontWeight:500,lineHeight:"18px",textAlign:"center",textTransform:"capitalize",children:[e.jsx(p,{icon:"tabler:point-filled",rotate:3,color:`${t?"#2E90FA":"#12B76A"}`}),t?"Completed":"Active"]})}),u=()=>{const{device:t}=n.info;let i=[];for(let l of t)i=[...i,Number(l.deviceNeeded)];return i.reduce((l,m)=>l+m,0)},d=()=>{if(r.data){const t=S.groupBy(r.data.data.listOfReceivers,"paymentIntent");if(t[n.info.paymentIntent]){let i=[],l=0,m=1;const b=0;for(let x of t[n.info.paymentIntent])x.device.status===!0&&(i.splice(l,b,m),l++);return i.reduce((x,I)=>x+I,0)}else return 0}return 0},f=new Date;return e.jsx(w,{title:`${n.info.date?`${E(n.info.date)} ${new Date(n.info.date).getDate()}, ${new Date(n.info.date).getFullYear()}
              `:f}`,extra:s(n.active),style:{width:300,margin:"0.5rem auto 1rem"},styles:{header:{borderBottom:"transparent",color:"#6941c6"}},children:e.jsxs(o,{container:!0,children:[e.jsx(o,{display:"flex",justifyContent:"flex-start",alignItems:"center",margin:"0 0 -15px",item:!0,xs:10,children:e.jsxs("p",{style:{width:"100%",alignSelf:"stretch",color:"var(--gray-900, #101828)",fontSize:"18px",fontFamily:"Inter",fontStyle:"normal",fontWeight:700,lineHeight:"28px",textAlign:"left",textTransform:"none"},children:["Total devices: ",u()]})}),e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",margin:"0 0 -15px",item:!0,xs:12,children:[e.jsxs("p",{style:{width:"100%",alignSelf:"stretch",color:"var(--gray-600, #475467)",fontSize:"16px",fontFamily:"Inter",fontStyle:"normal",fontWeight:400,lineHeight:"24px",textAlign:"left",textTransform:"none"},children:[u()>1?"Devices":"Device"," in use:"," ",d(),"/",u()]}),d()>0?e.jsx(p,{icon:"fluent:shifts-activity-20-filled",width:25,color:"#ff0000"}):e.jsx(p,{icon:"ei:check",width:30,color:"#6ce792"})]}),e.jsx(o,{display:"flex",justifyContent:"flex-start",alignItems:"center",item:!0,xs:10,children:e.jsxs("p",{style:{width:"100%",alignSelf:"stretch",color:"var(--gray-600, #475467)",fontSize:"16px",fontFamily:"Inter",fontStyle:"normal",fontWeight:400,lineHeight:"24px",textAlign:"left",textTransform:"none"},children:["Deposit amount: ",c.id===1?"$0":null]})}),e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",margin:"0.5rem auto",item:!0,xs:10,children:e.jsx(D,{errorLevel:"H",value:`${n.info.paymentIntent}`,icon:"https://i.ibb.co/kKktFyw/maskable-icon.png",iconSize:50})}),e.jsxs("p",{style:{width:"100%",alignSelf:"stretch",color:"var(--gray-600, #475467)",fontSize:"14px",fontFamily:"Inter",fontStyle:"normal",fontWeight:400,lineHeight:"20px",textAlign:"center",textTransform:"none"},children:["Order number: ",n.info.paymentIntent]})]})})}else return[]},N=()=>{var d,f;const{consumer:n}=h(t=>t.consumer),c=F(),a=v({queryKey:["transactions"],queryFn:()=>y.post("/transaction/transaction",{"consumerInfo.email":n.email}),refetchOnMount:!1});g.useEffect(()=>{const t=new AbortController;return a.refetch(),()=>{t.abort()}},[]);const r=(f=(d=a==null?void 0:a.data)==null?void 0:d.data)==null?void 0:f.list;g.useCallback(()=>{if(r){const t={};for(let i of r)t[i.paymentIntent]?y.delete(`/transaction/remove-duplicate-transaction/${i.id}`):t[i.paymentIntent]=i}},[r])();const u=()=>c(n?"/deviceSelection":"/initial-form");return e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:"0.5rem auto 4rem",container:!0,children:[e.jsxs(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:"2rem auto 2rem",item:!0,xs:10,children:[e.jsx("h1",{style:{color:"var(--gray-900, #101828)",textAlign:"center",fontFamily:"Inter",fontSize:"24px",fontStyle:"normal",fontWeight:"600",lineHeight:"32px"},children:"Order details"}),e.jsx("h4",{style:{color:"var(--gray-600, #475467)",textAlign:"center",fontFamily:"Inter",fontSize:"16px",fontStyle:"normal",fontWeight:"400",lineHeight:"24px"},children:"View your current orders and request more."})]}),e.jsx(o,{display:"flex",flexDirection:"column",alignItems:"center",margin:"1rem auto 0rem",item:!0,xs:10,children:n&&r?r==null?void 0:r.toReversed().map(t=>e.jsx("span",{children:e.jsx(k,{info:t})},t.id)):e.jsx(C,{description:e.jsx("h1",{style:{color:"var(--gray-600, #475467)",textAlign:"center",fontFamily:"Inter",fontSize:"16px",fontStyle:"normal",fontWeight:"400",lineHeight:"24px"},children:"No order."})})}),e.jsx(o,{display:"flex",alignItems:"center",justifyContent:"center",margin:"1rem auto 0rem",width:"100%",item:!0,xs:10,children:e.jsx(A,{onClick:()=>u(),style:{display:"flex",padding:"12px 20px",justifyContent:"center",alignItems:"center",borderRadius:"8px",border:"1px solid var(--blue-dark-600, #155EEF)",background:"var(--blue-dark-600, #155EEF)",boxShadow:"0px 1px 2px 0px rgba(16, 24, 40, 0.05)",width:"100%"},children:e.jsx(j,{style:{textTransform:"none",fontFamily:"Inter",fontSize:"18px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",color:"#fff"},children:"Create new order"})})})]})};export{N as default};
